
## Эксепшен и ошибка

Exception - не является ошибкой как таковой. Он говорит о том что какие действия нельзя выполнить но при этом это не ошибка.

Так если пользователь пытается авторизоваться по неверному логину паролю мы получим Exception.

Если пользователь при выполнении запроса стучится к мёртвому серверу то сервер отдаёт нам Exception.

Exception - возможный вариант поведения приложения при определённых действиях. Мы можем ожидать что пользователь введёт пароль не правильно. Мы можем ожидать что сервер ответит сообщением о том что он мёртв или не ответит вообще.

Ошибка это вариант поведения приложения которое невозможно предсказать. К примеру если в коде содержится баг который приводит к его крашу. Мы должны отлавливать эксепшены.

## Как выглядит отловка ошибки.

### Domain Data

На уровне domain и data source всё что нам нужно делать это вызывать метод rethrow, который прокинет ошибку дальше в таком же виде в котором она была получена этим методом.

Изредка при необходимости можно выполнить дополнительное действие к примеру вызвать метод лога с определённой информацией или что-то ещё

```dart
Future<void> login(string login, string password)async{

try{
	return _authDS.login(login,password);
} on Object {
	rethrow;
}
}
```

Для работы с ошибками используется trye catch. При этом отлавливать мы должны всегда object потому что ошибки бывают разных типов.

### UI

В интерфейсе мы должны более конкретно указать пользователю на то что пошло не так, поэтому там используются сложные конструкции.

```dart
Future<void> login(String login, String password)async{

try{
 await model.login(login,password);
} on DioException{
// Показываем ошибку связанную с запросом
// Здесь будет инфа о том что сервер мёртв или логин/пароль неправильный
// Как и любая другая ошибка которую отдаст сервер
} on TimeoutException {
// Здесь ошибка времени подключения
// Если запрос идёт больше определённого заранее заданного времени
// Будет получена эта ошибка
} on TypeError {
// Если json который пришёл с сервера непрвильный
} on Exception {
// Любой другой вид ошибки
} on Object {
// Неизвестная хтонь с которой непонятно что делать
}
}
```

Также можно получить экземпляр класса ошибки и обработать его. Ниже представлен пример обработки DioException с его экземпляром.

```dart
on DioException catch (e){

final data = e.response?.data as Map<String,dynamic>?;

if(data == null) return;

final errorMessage = data['message'];

if(errorMessage == null) return;

_controller.error(errorMessage);
}
```

